<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GesSense</title>
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/index.css">

</head>
<body>
<div class="outer">
    <header>
        <div class="header">
            <img src="./img/plus.png">
            <img src="./img/setting.png">
        </div>
        <h4>GesSense</h4>
    </header>
    <section>
        <div class="border">
            <div class="border-one">
                <img src="./img/bulb.png">
                <h6>灯光</h6>
            </div>
            <div class="border-two">
                <div class="shouShi"><button onclick="light()"><b>手势</b></button></div>
                <div class="name"><p><b>客厅</b></p></div>
                <div id="switch-body1" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-three">
                <div class="shouShi"><button onclick="light()"><b>手势</b></button></div>
                <div class="name"><p><b>主卧</b></p></div>
                <div id="switch-body2" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-four">
                <div class="shouShi"><button onclick="light()"><b>手势</b></button></div>
                <div class="name"><p><b>次卧</b></p></div>
                <div id="switch-body3" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-five">
                <div class="shouShi"><button onclick="light()"><b>手势</b></button></div>
                <div class="name"><p><b>厨房</b></p></div>
                <div id="switch-body4" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>

            <div class="border-six">
                <img src="./img/XX_033.png">
                <h6>窗帘</h6>
            </div>
            <div class="border-seven">
                <div class="shouShi"><button onclick="chuanglian()"><b>手势</b></button></div>
                <div class="name"><p><b>客厅</b></p></div>
                <div id="switch-body5" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-eight">
                <div class="shouShi"><button onclick="chuanglian()"><b>手势</b></button></div>
                <div class="name"><p><b>主卧</b></p></div>
                <div id="switch-body6" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-nine">
                <div class="shouShi"><button onclick="chuanglian()"><b>手势</b></button></div>
                <div class="name"><p><b>次卧</b></p></div>
                <div id="switch-body7" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>

            <div class="border-ten">
                <img src="./img/kongtiao.png">
                <h6>空调</h6>
            </div>
            <div class="border-eleven">
                <div class="shouShi"><button onclick="kontiao()"><b>手势</b></button></div>
                <div class="name"><p><b>客厅</b></p></div>
                <div id="switch-body8" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-twelve">
                <div class="shouShi"><button onclick="kontiao()"><b>手势</b></button></div>
                <div class="name"><p><b>主卧</b></p></div>
                <div id="switch-body9" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-thirteen">
                <div class="shouShi"><button onclick="kontiao()"><b>手势</b></button></div>
                <div class="name"><p><b>次卧</b></p></div>
                <div id="switch-body10" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>

            <div class="border-forth">
                <img src="./img/menjin.png">
                <h6>门</h6>
            </div>
            <div class="border-fifth">
                <div class="shouShi"><button onclick="men()"><b>手势</b></button></div>
                <div class="name"><p><b>客厅</b></p></div>
                <div id="switch-body11" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-sixth">
                <div class="shouShi"><button onclick="men()"><b>手势</b></button></div>
                <div class="name"><p><b>主卧</b></p></div>
                <div id="switch-body12" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>
            <div class="border-seventh">
                <div class="shouShi"><button onclick="men()"><b>手势</b></button></div>
                <div class="name"><p><b>次卧</b></p></div>
                <div id="switch-body13" class="switch">
                    <input type="checkbox" name="" class="switch__input">
                    <span class="switch__label switch__label--left">
                            <!--<span>是</span>-->
                        </span>
                    <span class="switch__core" style="width: 40px;"></span>
                    <span class="switch__label switch__label--right">
                            <!--<span>否</span>-->
                        </span>
                </div>
            </div>

        </div>
    </section>
    <footer>
        <div class="footer">
            <div class="footer-one" id="footer-one">
                <img src="./img/tablet.png">
                <span><b>设备</b></span>
            </div>
            <div class="footer-two" id="footer-two">
                <img src="./img/aixin.png">
                <span><b>健康</b></span>
            </div>
            <div class="footer-three" id="footer-three">
                <img src="./img/user.png">
                <span><b>我的</b></span>
            </div>
        </div>
    </footer>
</div>
<script src='js/jquery-1.11.min.js'></script>
<!--jquery弹出层插件-->
<script src='js/jquery.popup.min.js'></script>
<script src="./js/zepto.min.js"></script>
<script src="./js/flexible.js"></script>
<script src='./js/index.js'></script>
<script src="js/mui.js"></script>
<script type="text/javascript">
	mui.init();
	mui.plusReady(function () {
		
		// mui.ajax('http://74.48.160.188:8888/api/v1/equipments', {
		// 	type: 'get', // 假设API需要POST请求
		// 	dataType: 'json', // 假设API返回的数据格式是JSON
		// 	headers: {
		// 		'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo4NTE3NDEzMTA0NTU4MDgsInVzZXJuYW1lIjoicm9zeXJhaW4iLCJpc3MiOiJ3b2FuanUiLCJleHAiOjE3NDY1NDA5MDd9.cYpAHVJ1BATfLWifLeUd-3yWXWL6XZFcGficHpQM7Ac'
		// 	},
		// 	success: function(response) {
		// 		// 打印整个响应对象以进行调试
		// 		console.log('服务器响应：', response.data);
		
		// 		// 检查响应状态码
		// 		if (response.code === 1000 && response.msg === 'success') {
					
		// 			if(Array.isArray(response.data)){
		// 				response.data.some(function(equipment){
		// 					console.log(equipment.status)
		// 					if (response.data.equipment_id == '36339684464398336') {
		// 						initSwitch("switch-body2", equipment.status)
		// 					}
		// 				})
						
		// 			}
		// 		} else {
		// 			console.error('接口返回错误：', response.msg);
		
		// 		}
		// 	},
		// 	error: function(xhr, type, error) {
		// 		var errorText = xhr.responseText;
		// 		// 打印错误信息
		// 		console.error('请求失败：', errorText);
		// 		// 可以在这里提供用户反馈或执行其他错误处理逻辑
		// 	}
		// });
		
		mui.ajax('http://74.48.160.188:8888/api/v1/equipments', {
		    type: 'get',
		    dataType: 'json',
			headers: {
				'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo4NTE3NDEzMTA0NTU4MDgsInVzZXJuYW1lIjoicm9zeXJhaW4iLCJpc3MiOiJ3b2FuanUiLCJleHAiOjE3NDY1NDA5MDd9.cYpAHVJ1BATfLWifLeUd-3yWXWL6XZFcGficHpQM7Ac'
			},
		    success: function(response) {
		        console.log('服务器响应：', response);
		
		        // 检查响应状态码
		        if (response.code === 1000 && response.msg === 'success') {
		            // 确保response.data是数组
		            if (Array.isArray(response.data)) {
		                // 遍历设备数组
		                response.data.forEach(function(equipment) {
		                    console.log(equipment.status); // 打印每个设备的状态
		
		                    // 根据设备名称更新对应开关的状态
		                    switch (equipment.equipment_name) {
		                        case '灯':
		                            initSwitch("switch-body2", equipment.status);
		                            break;
		                        case '窗户':
		                            initSwitch("switch-body6", equipment.status);
		                            break;
		                        case '空调':
		                            initSwitch("switch-body9", equipment.status);
		                            break;
		                        case '门':
		                            initSwitch("switch-body12", equipment.status);
		                            break;
		                        // 可以继续添加其他设备的case
		                    }
		                });
		            } else {
		                console.error('data属性不存在或不是一个数组/');
		            }
		        } else {
		            console.error('接口返回错误：', response.msg);
		        }
		    },
		    error: function(xhr, type, error) {
		        var errorText = xhr.responseText;
		        console.error('请求失败：', errorText);
		    }
		});
		
		document.getElementById('footer-two').addEventListener('tap', function() {
				mui.openWindow({
					url:'heart.html',
					id:'heart',
					show:{
						autoShow:true
					},
					waiting:{
						autoShow:true,
						title:'正在加载...'
					}
				})
		})
		
		document.getElementById('footer-three').addEventListener('tap', function() {
				mui.openWindow({
					url:'my.html',
					id:'my',
					show:{
						autoShow:true
					},
					waiting:{
						autoShow:true,
						title:'正在加载...'
					}
				})
		})
		
		
		
	})
	function light() {
		mui.openWindow({
			url:'light.html',
			id:'light',
			show:{
				autoShow:true
			},
			waiting:{
				autoShow:true,
				title:'正在加载...'
			}
		})
	}
	
	function chuanglian() {
		mui.openWindow({
			url:'chuanglian.html',
			id:'chuanglian',
			show:{
				autoShow:true
			},
			waiting:{
				autoShow:true,
				title:'正在加载...'
			}
		})
	}
	
	function kontiao() {
		mui.openWindow({
			url:'kontiao.html',
			id:'kontiao',
			show:{
				autoShow:true
			},
			waiting:{
				autoShow:true,
				title:'正在加载...'
			}
		})
	}
	
	function men() {
		mui.openWindow({
			url:'men.html',
			id:'men',
			show:{
				autoShow:true
			},
			waiting:{
				autoShow:true,
				title:'正在加载...'
			}
		})
	}
</script>
</body>
</html>